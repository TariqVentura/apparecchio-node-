<nav class="sidebar close">
    <header>
        <div class="image-text">
            <span class="image">
                <!--<img src="logo.png" alt="">-->
            </span>
            <div class="text logo-text">
                <span class="name">Apparecchio</span>
            </div>
        </div>
        <i class='bx bx-chevron-right toggle'></i>
    </header>
    <!--Enlaces dashboard-->
    <div class="menu-bar">
        <div class="menu">
            <ul class="menu-links">
                <li class="nav-link">
                    <a href="/principal">
                        <i><img src="https://img.icons8.com/sf-black-filled/48/null/home.png" /></i>
                        <span class="text nav-text">Dashboard</span>
                    </a>
                </li>
                <!--Enlace a la página de pedidos-->
                <li class="nav-link">
                    <a href="/pedidos">
                        <i><img src="https://img.icons8.com/ios-glyphs/40/null/shopping-cart--v1.png" /></i>
                        <span class="text nav-text">Pedidos</span>
                    </a>
                </li>
                <!--Enlace a la página de clientes-->
                <li class="nav-link">
                    <a href="/clientes">
                        <i><img src="https://img.icons8.com/sf-black-filled/48/null/conference-call.png" /></i>
                        <span class="text nav-text">Clientes</span>
                    </a>
                </li>
                <!--Enlace a la página de productos-->
                <li class="nav-link">
                    <a href="/productos">
                        <i><img src="https://img.icons8.com/material-sharp/42/null/package.png" /></i>
                        <span class="text nav-text">Productos</span>
                    </a>
                </li>
                <!--Enlace a la página de usuarios-->
                <li class="nav-link">
                    <a href="/usuarios">
                        <i><img src="https://img.icons8.com/fluency-systems-filled/48/null/user.png" /></i>
                        <span class="text nav-text">Usuarios</span>
                    </a>
                </li>
                <!--Enlace a la página de categorias-->
                <li class="nav-link">
                    <a href="/categorias">
                        <i><img
                                src="https://img.icons8.com/external-others-inmotus-design/40/null/external-Check-List-check-others-inmotus-design.png" /></i>
                        <span class="text nav-text">Categorias</span>
                    </a>
                </li>
                <li class="nav-link">
                    <a href="/Marcas">
                        <i><img
                                src="https://img.icons8.com/external-sbts2018-outline-sbts2018/40/null/external-brand-basic-ui-elements-2.2-sbts2018-outline-sbts2018.png" /></i>
                        <span class="text nav-text">Marcas</span>
                    </a>
                </li>
            </ul>
        </div>
        <div class="bottom-content">
            <!--Logout/cierre de sesión-->
            <li class="">
                <a href="/">
                    <i><img
                            src="https://img.icons8.com/external-tanah-basah-glyph-tanah-basah/48/null/external-exit-essentials-tanah-basah-glyph-tanah-basah.png" /></i>
                    <span class="text nav-text">Logout</span>
                </a>
            </li>
            <!--Boton de modo oscuro-->
            <li class="mode">
                <div class="sun-moon">
                    <i class='bx bx-moon icon moon'></i>
                    <i class='bx bx-sun icon sun'></i>
                </div>
                <span class="mode-text text">Dark mode</span>
                <div class="toggle-switch">
                    <span class="switch"></span>
                </div>
            </li>
        </div>
    </div>
</nav>
<section class="home">
    <div class="container">
        <div class="text">
            <h2>Usuarios</h2>
        </div>
        <div class="row justify-content-md-center">
            <!--Buscador-->
            <div class="col-md-5">
                <form method="post" id="search-form">
                    <div class="input-field  flex-nowrap col-12">
                        <img src="https://img.icons8.com/ios-filled/32/null/search--v1.png" />
                        <input id="search" type="text" name="Buscar " placeholder="Buscar" required>
                        <button type="button" id="btn-search" class="btn waves-effect green tooltipped"
                            data-tooltip="Buscar">
                            <img src="https://img.icons8.com/glyph-neue/40/null/ok--v1.png" />
                        </button>
                    </div>
                </form>
            </div>
            <!--Botón de añadir que abre un modal para crear usuario-->
            <div class="col-md-3">
                <!-- Button trigger modal -->
                <button type="button" class="btn btn-primary mt-3" data-bs-toggle="modal"
                    data-bs-target="#staticBackdrop">
                    Insertar Datos
                </button>

                <!-- Modal -->
                <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false"
                    tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="staticBackdropLabel">Crear Usuario</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col">
                                        <form action="/api/users" method="post">
                                            <div class="row">
                                                Nombre: <input type="text" name="name" required>
                                                Apellido: <input type="text" name="lastname" required>
                                            </div>
                                            <div class="row">
                                                Correo: <input type="email" name="email" required>
                                                Carnet: <input type="text" name="identity_card" required>
                                            </div>
                                            <div class="row">
                                                Usuario: <input type="text" name="user" required>
                                                Contraseña: <input type="password" name="password" required>
                                            </div>
                                            <button type="submit" class="btn btn-primary">Enviar</button>
                                            <button type="button" class="btn btn-secondary"
                                                data-bs-dismiss="modal">Cerrar</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <table class="table table-bordered table-hover text-light">
                    <thead>
                        <tr>
                            <th scope="col">Nombre</th>
                            <th scope="col">Apellido</th>
                            <th scope="col">Correo</th>
                            <th scope="col">Usuario</th>
                            <th scope="col">Estado</th>
                            <th scope="col">Actualizar</th>
                            <th scope="col">Eliminar</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% users.forEach((data)=> { %>
                            <tr>
                                <td>
                                    <%= data.name %>
                                </td>
                                <td>
                                    <%= data.lastname %>
                                </td>
                                <td>
                                    <%= data.email %>
                                </td>
                                <td>
                                    <%= data.user %>
                                </td>
                                <td>
                                    <%= data.status %>
                                </td>
                                <td>
                                    <button class="btn btn-info mt-3"><a href="/_updateUsers/users?id=<%= data._id %>"
                                            class="text-light text-decoration-none">Actualizar</a></button>
                                </td>
                                <td>
                                    <!-- Button trigger modal -->
                                    <button type="button" class="btn btn-danger" data-bs-toggle="modal"
                                        data-bs-target="#staticBackdrop<%= data._id %>delete">
                                        Eliminar
                                    </button>

                                    <!-- Modal -->
                                    <div class="modal fade" id="staticBackdrop<%= data._id %>delete"
                                        data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
                                        aria-labelledby="staticBackdropLabel" aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Eliminar
                                                        Categoria
                                                    </h1>
                                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                        aria-label="Close"></button>
                                                </div>
                                                <div class="modal-body">
                                                    ¿Esta seguro que desea eliminar al cliente <%= data.user %>?
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary"
                                                        data-bs-dismiss="modal">Cancelar</button>
                                                    <button class="btn btn-danger"><a
                                                            href="/api/users/delete?id=<%= data._id %>"
                                                            class="text-light text-decoration-none">Eliminar</a></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <%})%>
                    </tbody>
                </table>
            </div>
        </div>
        <input type="text" value="<%= confirmation %>" id="confirmation" hidden>
        <input type="text" value="<%= mensaje %>" id="mensaje" hidden>
        <input type="text" value="<%= icon %>" id="icon" hidden>
    </div><br>

    <!--tabla de contenido-->

</section>

<script>
    const body = document.querySelector('body'),
        sidebar = body.querySelector('nav'),
        toggle = body.querySelector(".toggle"),
        modeSwitch = body.querySelector(".toggle-switch"),
        modeText = body.querySelector(".mode-text");
    toggle.addEventListener("click", () => {
        sidebar.classList.toggle("close");
    })
    modeSwitch.addEventListener("click", () => {
        body.classList.toggle("dark");
        if (body.classList.contains("dark")) {
            modeText.innerText = "Light mode";
        } else {
            modeText.innerText = "Dark mode";
        }
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="/dashboard/usuarios.js"></script>